
pipeline:
      
  build:
    image: golang
    environment:
     - GIT_USER=${GIT_USER}
     - GIT_PASS=${GIT_PASS}
     
    commands:
      - printenv 
      - echo $GIT_USER && echo $GIT_PASS
      - cd /root && echo "machine github.com" >> .netrc && echo "login $GIT_USER" >> .netrc && echo "password $GIT_PASS" >> .netrc
      - cat .netrc
      - cd -
      - go get 
      - go build
      
                  
            
  gcr:
    image: plugins/docker
    registry: gcr.io
    repo: gcr.io/zang-api-sandbox/godrone
    privileged: true
    secrets: [ docker_username, docker_password ]
    debug: true

